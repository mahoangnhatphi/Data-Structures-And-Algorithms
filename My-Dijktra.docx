#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#define true 1
#define false 0
#define MAX 100
/* run this program using the console pauser or add your own getch, system("pause") or input loop */

int size;
int begin, end;
int g[MAX][MAX];

void read(char fileName[]) {
	FILE *f = fopen(fileName, "r");
	fscanf(f,"%d %d %d\n", &size, &begin, &end);
	int check = false;
	for (int i = 0; i < size; i++) {
		for  (int j = 0; j < size; j++)
		if (fscanf(f, "%d", &g[i][j]) == EOF) {
			check  = true;
			break;
		}
		if (check) break;
	}
	fclose(f);
}

int dijktra() {
	// kh?i t?o giá tr? m?c ??nh cho ba m?ng ?ánh d?u ?ã ?i qua, ?i?m ?ã ?i qua tr??c ?ó,
	// và chi phí ?? ?i t? ?i?m ??u ??n ?ó.
	int isVisit[MAX], pre[MAX], len[MAX];
	for (int i = 0; i < size; i++) {
		isVisit[i] = false;
		pre[i] = -1;
		len[i] = INT_MAX;
	}
	
	int vBegin = begin - 1;
	int vEnd = end - 1;
	
	len[vBegin] = 0;
	
	while (isVisit[vEnd] == false) { // ?i?m mu?n ??n ch?a ?i ??n ???c
//		for (int j = 0; j < size; j++)
//			printf("%5d ", isVisit[j]);
//		printf("\n");
//		for (int j = 0; j < size; j++)
//			printf("%5d ", pre[j]);
//		printf("\n");
//		for (int j = 0; j < size; j++)
//			printf("%5d ", len[j]);
//		
		int i;
		for (i = 0; i < size; i++) 
			if (isVisit[i] == false && len[i] < INT_MAX) {
				break;
			} // tìm ?i?m ch?a xét nh?ng ?ã có ?i?m ?i t?i ???c
		
		if (i >= size) {
			return -1;
		} // ?ã xét t?t c? các ?i?m và không th? ?i t?i ?i?m c?n ??n
		for	(int j = 0; j < size; j++) 
			if (isVisit[j] == false && len[j] < len[i]) {
				i = j;
			} // tìm ?i?m có chi phí ?i th?p nh?t hi?n t?i mà v?n ch?a ?i t? ?i?m ?ó
			// g?i ?ây là ?i?m t?t nh?t th?i ?i?m hi?n t?i (tính t? ?i?m tr??c ?ó. N?u suy tr??c c?a tr??c c?a tr??c ta có ?i?m b?t ??u) ?? b?t ??u ?i qua các ?i?m ch?a ???c xu?t phát. Goi ?ây là ?i?m M	
//		printf("\n%d\n---------\n",i);
		isVisit[i] = true; // cho ?i?m có chi phí th?p nh?t mà ch?a ?i t? ?i?m ?ó là ?ã ?i qua
		for (int j = 0; j < size; j++)
			if (isVisit[j] == false && len[i] + g[i][j] < len[j] && g[i][j] != 0) {
				len[j] = len[i] + g[i][j];
				pre[j] = i;
			} // n?u ?i?m ch?a xu?t phát t? ?ó và có chi phí t? ?i?m M t?i ?i?m ?ó ph?i nh? h?n chi phí t? ?i?m ti?n nhi?m ??n nó
			// l?u ý ph?i có giá tr? là khác không nh?m tránh tr??ng h?p sai sót khi tìm M ? b??c sau
	}	
// truy v?t l?y b??c ?i
	int step[MAX], sizeStep = 0, i = vEnd;
	do {
		step[sizeStep++] = i + 1;
		i = pre[i];		
	} while (i != -1);
	printf("Path: ");
	for (int i = sizeStep - 1; i > 0; i--) printf("%d->",step[i]);
	printf("%d\n", step[0]);
	return len[vEnd];
}

int main(int argc, char *argv[]) {
	read("input.txt");
	printf("Minimum value must be paid to move from %d to %d is %d", begin, end, dijktra());
	return 0;
}
